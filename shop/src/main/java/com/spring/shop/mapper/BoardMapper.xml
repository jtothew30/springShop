<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.spring.shop.mapper.BoardMapper">
	
	<select id="selectTest" resultType="com.spring.shop.vo.Board">
		select * from proboard;
	</select>
	
	
	<!-- 수정중 -->
	<select id="selectCount" resultType="int">
		SELECT COUNT(*) as count FROM proboard;
	</select>	
	
 	<select id="selectBoardList" resultType="com.spring.shop.vo.Board">
		<![CDATA[
		SELECT * FROM (
				SELECT * FROM (
					select rownum rn, p.* from proboard p 
				 )
           ) WHERE row_num >= #{startNum}
         ) WHERE row_num <= #{endNum}
		]]>
	</select>
	 
	<select id="selectBoard" resultType="com.spring.shop.vo.Board" parameterType="int">
		SELECT * FROM BOARD WHERE NUM = #{num}
	</select>
	<!-- mybatis3은 파라미터를 생략해도 된다. 하지만 명시해 주는 것이 유지보수에 좋다. -->
	
	<select id="maxNum" resultType="int">
		SELECT NVL(MAX(num)+1,1) as num FROM BOARD
	</select>
	
	<select id="checkId" resultType="string" parameterType="string">
		SELECT id FROM member WHERE id = #{id}
	</select>
	
	<select id="login" resultType="com.spring.shop.vo.Board">
		SELECT * FROM MEMBER WHERE id = #{id} and pwd = #{pwd}
	</select>
	
	<insert id="insertBoard">
		INSERT INTO BOARD (num, title, content, passwd, indate, views, mem_id, filename) 
		VALUES (NVL((SELECT max(num)+1 FROM BOARD),1), #{title}, #{content}, #{passwd}, CURRENT_DATE, 0, #{mem_id}, #{filename,jdbcType=VARCHAR})
	</insert>
	
	<delete id="deleteBoard">
		DELETE FROM BOARD WHERE num = #{num}
	</delete>
	
	<update id="updateBoard">		
		UPDATE BOARD SET passwd = #{passwd}, title = #{title},
		content=#{content}, filename=#{filename} WHERE num = #{num}
	</update>
	
	
</mapper>